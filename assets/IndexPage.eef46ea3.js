import{u as Z,a as ee,Q as T}from"./QSpinner.a99441ee.js";import{R as te}from"./Ripple.743f3be4.js";import{u as le,a as ne,b as ae,c as ie,d as ue,e as oe,f as re,g as se,h as ce,i as U,_ as de,Q as fe,j as me,k as ve}from"./plugin-vue_export-helper.eac69ca2.js";import{c as X,a as c,h as p,p as E,E as K,k as A,F as ge,G as he,H as be,I as pe,d as Se,J as ye,o as xe,b as Fe,w as O,K as Q,g as W,e as $}from"./index.89df8e12.js";import{d as _e,e as Ce}from"./dom.74cd8572.js";const ke={xs:8,sm:10,md:14,lg:20,xl:24};var qe=X({name:"QChip",props:{...le,...Z,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:d,emit:m}){const{proxy:{$q:g}}=E(),o=ne(e,g),f=ee(e,ke),s=c(()=>e.selected===!0||e.icon!==void 0),a=c(()=>e.selected===!0?e.iconSelected||g.iconSet.chip.selected:e.icon),h=c(()=>e.iconRemove||g.iconSet.chip.remove),F=c(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),q=c(()=>{const n=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(n?` text-${n} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(F.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(o.value===!0?" q-chip--dark q-dark":"")}),C=c(()=>{const n=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},k={...n,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||g.lang.label.remove};return{chip:n,remove:k}});function I(n){n.keyCode===13&&V(n)}function V(n){e.disable||(m("update:selected",!e.selected),m("click",n))}function z(n){(n.keyCode===void 0||n.keyCode===13)&&(K(n),e.disable===!1&&(m("update:modelValue",!1),m("remove")))}function r(){const n=[];F.value===!0&&n.push(p("div",{class:"q-focus-helper"})),s.value===!0&&n.push(p(T,{class:"q-chip__icon q-chip__icon--left",name:a.value}));const k=e.label!==void 0?[p("div",{class:"ellipsis"},[e.label])]:void 0;return n.push(p("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},Ce(d.default,k))),e.iconRight&&n.push(p(T,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&n.push(p(T,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:h.value,...C.value.remove,onClick:z,onKeyup:z})),n}return()=>{if(e.modelValue===!1)return;const n={class:q.value,style:f.value};return F.value===!0&&Object.assign(n,C.value.chip,{onClick:V,onKeyup:I}),_e("div",n,r(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[te,e.ripple]])}}});function D(e,d,m,g){const o=[];return e.forEach(f=>{g(f)===!0?o.push(f):d.push({failedPropValidation:m,file:f})}),o}function j(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),K(e)}const Ie={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Ve=["rejected"];function ze({editable:e,dnd:d,getFileInput:m,addFilesToQueue:g}){const{props:o,emit:f,proxy:s}=E(),a=A(null),h=c(()=>o.accept!==void 0?o.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),F=c(()=>parseInt(o.maxFiles,10)),q=c(()=>parseInt(o.maxTotalSize,10));function C(t){if(e.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&ge(t);else{const y=m();y&&y!==t.target&&y.click(t)}}function I(t){e.value&&t&&g(null,t)}function V(t,y,B,P){let i=Array.from(y||t.target.files);const S=[],_=()=>{S.length!==0&&f("rejected",S)};if(o.accept!==void 0&&h.value.indexOf("*/")===-1&&(i=D(i,S,"accept",u=>h.value.some(v=>u.type.toUpperCase().startsWith(v)||u.name.toUpperCase().endsWith(v))),i.length===0))return _();if(o.maxFileSize!==void 0){const u=parseInt(o.maxFileSize,10);if(i=D(i,S,"max-file-size",v=>v.size<=u),i.length===0)return _()}if(o.multiple!==!0&&i.length!==0&&(i=[i[0]]),i.forEach(u=>{u.__key=u.webkitRelativePath+u.lastModified+u.name+u.size}),P===!0){const u=B.map(v=>v.__key);i=D(i,S,"duplicate",v=>u.includes(v.__key)===!1)}if(i.length===0)return _();if(o.maxTotalSize!==void 0){let u=P===!0?B.reduce((v,R)=>v+R.size,0):0;if(i=D(i,S,"max-total-size",v=>(u+=v.size,u<=q.value)),i.length===0)return _()}if(typeof o.filter=="function"){const u=o.filter(i);i=D(i,S,"filter",v=>u.includes(v))}if(o.maxFiles!==void 0){let u=P===!0?B.length:0;if(i=D(i,S,"max-files",()=>(u++,u<=F.value)),i.length===0)return _()}if(_(),i.length!==0)return i}function z(t){j(t),d.value!==!0&&(d.value=!0)}function r(t){K(t),(t.relatedTarget!==null||he.is.safari!==!0?t.relatedTarget!==a.value:document.elementsFromPoint(t.clientX,t.clientY).includes(a.value)===!1)===!0&&(d.value=!1)}function n(t){j(t);const y=t.dataTransfer.files;y.length!==0&&g(null,y),d.value=!1}function k(t){if(d.value===!0)return p("div",{ref:a,class:`q-${t}__dnd absolute-full`,onDragenter:j,onDragover:j,onDragleave:r,onDrop:n})}return Object.assign(s,{pickFiles:C,addFiles:I}),{pickFiles:C,addFiles:I,onDragover:z,onDragleave:r,processFiles:V,getDndNode:k,maxFilesNumber:F,maxTotalSizeNumber:q}}const G=["B","KB","MB","GB","TB","PB"];function De(e,d=1){let m=0;for(;parseInt(e,10)>=1024&&m<G.length-1;)e/=1024,++m;return`${e.toFixed(d)}${G[m]}`}var Be=X({name:"QFile",inheritAttrs:!1,props:{...ae,...ie,...Ie,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...ue,...Ve],setup(e,{slots:d,emit:m,attrs:g}){const{proxy:o}=E(),f=oe(),s=A(null),a=A(!1),h=re(e),{pickFiles:F,onDragover:q,onDragleave:C,processFiles:I,getDndNode:V}=ze({editable:f.editable,dnd:a,getFileInput:L,addFilesToQueue:M}),z=se(e),r=c(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),n=c(()=>U(r.value)),k=c(()=>r.value.map(l=>l.name).join(", ")),t=c(()=>De(r.value.reduce((l,b)=>l+b.size,0))),y=c(()=>({totalSize:t.value,filesNumber:r.value.length,maxFiles:e.maxFiles})),B=c(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:h.value,...g,id:f.targetUid.value,disabled:f.editable.value!==!0})),P=c(()=>"q-file q-field--auto-height"+(a.value===!0?" q-file--dnd":"")),i=c(()=>e.multiple===!0&&e.append===!0);function S(l){const b=r.value.slice();b.splice(l,1),u(b)}function _(l){const b=r.value.indexOf(l);b!==-1&&S(b)}function u(l){m("update:modelValue",e.multiple===!0?l:l[0])}function v(l){l.keyCode===13&&pe(l)}function R(l){(l.keyCode===13||l.keyCode===32)&&F(l)}function L(){return s.value}function M(l,b){const x=I(l,b,r.value,i.value),w=L();w!=null&&(w.value=""),x!==void 0&&((e.multiple===!0?e.modelValue&&x.every(J=>r.value.includes(J)):e.modelValue===x[0])||u(i.value===!0?r.value.concat(x):x))}function N(){return[p("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function Y(){if(d.file!==void 0)return r.value.length===0?N():r.value.map((b,x)=>d.file({index:x,file:b,ref:this}));if(d.selected!==void 0)return r.value.length===0?N():d.selected({files:r.value,ref:this});if(e.useChips===!0)return r.value.length===0?N():r.value.map((b,x)=>p(qe,{key:"file-"+x,removable:f.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{S(x)}},()=>p("span",{class:"ellipsis",textContent:b.name})));const l=e.displayValue!==void 0?e.displayValue:k.value;return l.length!==0?[p("div",{class:e.inputClass,style:e.inputStyle,textContent:l})]:N()}function H(){const l={ref:s,...B.value,...z.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:M};return e.multiple===!0&&(l.multiple=!0),p("input",l)}return Object.assign(f,{fieldClass:P,emitValue:u,hasValue:n,inputRef:s,innerValue:r,floatingLabel:c(()=>n.value===!0||U(e.displayValue)),computedCounter:c(()=>{if(e.counterLabel!==void 0)return e.counterLabel(y.value);const l=e.maxFiles;return`${r.value.length}${l!==void 0?" / "+l:""} (${t.value})`}),getControlChild:()=>V("file"),getControl:()=>{const l={ref:f.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return f.editable.value===!0&&Object.assign(l,{onDragover:q,onDragleave:C,onKeydown:v,onKeyup:R}),p("div",l,[H()].concat(Y()))}}),Object.assign(o,{removeAtIndex:S,removeFile:_,getNativeElement:()=>s.value}),be(o,"nativeEl",()=>s.value),ce(f)}});const Pe=Se({__name:"IndexPage",setup(e){const d=ye(),m=A(null),g=s=>{var h;const a=(h=s.dataTransfer)==null?void 0:h.files;a&&a.length>0&&o(a[0])},o=s=>{if(s.type==="application/octet-stream"||s.name.endsWith(".itdb")){localStorage.setItem("currentFileName",s.name);const a=new FileReader;a.onload=()=>{const h=a.result;localStorage.setItem("cachedFile",h),localStorage.setItem("fileTimestamp",Date.now().toString())},a.readAsText(s),d.push("/viewer")}else alert("Please upload a valid .itdb file.")},f=()=>{const s=document.querySelector("input[type=file]");s&&s.click()};return(s,a)=>(xe(),Fe(fe,{class:"upload",onDragover:a[2]||(a[2]=Q(()=>{},["prevent"])),onDrop:Q(g,["prevent"])},{default:O(()=>[a[4]||(a[4]=W("div",{class:"top-space"},null,-1)),$(ve,{class:"drop-zone",onDrop:g,onDragover:a[1]||(a[1]=Q(()=>{},["prevent"])),onClick:f},{default:O(()=>[$(me,null,{default:O(()=>[a[3]||(a[3]=W("p",null,"Drag and drop your ITDB file here, or click to select a file.",-1)),$(Be,{modelValue:m.value,"onUpdate:modelValue":[a[0]||(a[0]=h=>m.value=h),o],style:{display:"none"},accept:".itdb"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))}});var Te=de(Pe,[["__scopeId","data-v-6bda89ae"]]);export{Te as default};
